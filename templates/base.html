{% load static %}
{% url 'account_login' as login_url %}
{% url 'account_signup' as signup_url %}
{% url 'account_logout' as logout_url %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Home{% endblock %} | NextChaptr</title>
    <meta name="description" content="{% block description %}{% endblock %}">
    <meta name="keywords" content="{% block keywords %}{% endblock %}">
    {% block meta %}{% endblock %}
    {% block link %}{% endblock %}

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon_io/favicon.ico' %}">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Bitter:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <!-- Skip to main content -->
    <a data-testid="skip-to-main" class="visually-hidden-focusable position-absolute top-0 start-0 m-2 p-2 bg-body border rounded"
     href="#main-content">Skip to main content</a>
    <!-- Site header -->
    <nav data-testid="header" class="site-header">
      <div class="container py-3">
        <div class="d-flex align-items-center justify-content-between">
          <a class="navbar-brand brand-font fs-3 text-dark m-0" href="/">NextChaptr</a>
          <div class="d-flex align-items-center gap-2">
            {% if user.is_authenticated %}
              <div id="account-welcome">Hi, <strong>{{ user.username }}</strong></div>
              <div class="dropdown">
                <button type="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                        aria-label="Account menu"
                        class="btn-toggle-navbar d-flex align-items-center nc-btn nc-btn--icon nc-btn--sm nc-btn--ghost">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path fill="#00796b" d="M463 448.2C440.9 409.8 399.4 384 352 384L288 384C240.6 384 199.1 409.8 177 448.2C212.2 487.4 263.2 512 320 512C376.8 512 427.8 487.3 463 448.2zM64 320C64 178.6 178.6 64 320 64C461.4 64 576 178.6 576 320C576 461.4 461.4 576 320 576C178.6 576 64 461.4 64 320zM320 336C359.8 336 392 303.8 392 264C392 224.2 359.8 192 320 192C280.2 192 248 224.2 248 264C248 303.8 280.2 336 320 336z"/></svg>
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li><a class="dropdown-item" href="{% url 'library' %}">Library</a></li>
                  <li><a class="dropdown-item" href="{% url 'home' %}">Browse</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><a class="dropdown-item danger-color" href="{{ logout_url }}">Sign out</a></li>
                </ul>
              </div>
            {% else %}
              <a href="{{ signup_url }}" data-testid="sign-up" class="nc-btn nc-btn--primary nc-btn--sm">Sign up</a>
              <a href="{{ login_url }}" data-testid="log-in" class="nc-btn nc-btn--primary nc-btn--sm">Log in</a>
            {% endif %}
          </div>
        </div>
        {% block header_search %}{% endblock %}
      </div>
    </nav>
    <!-- Flash messages -->
    {% if messages %}
        <div class="message-overlay" aria-live="polite" aria-atomic="true">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
    {% endif %}
    <!--Optional Hero-->
    {% block hero %}{% endblock %}

    <!-- Main content -->
    <main id="main-content" class="container" tabindex="-1">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer data-testid="footer" class="mt-5">
        <div class="container py-4">
        <p class="mb-0">Â© 2025 NextChaptr</p>
        </div>
    </footer>
    {% include "activity/partials/confirm_delete_modal.html" %}

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
    <!-- Custom JavaScript -->
    <script src="{% static 'js/alerts.js' %}" defer></script>
    {% block extra_js %}{% endblock %}  
   
</body>
</html>