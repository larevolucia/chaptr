

    {% if request.user.is_authenticated %}
    
        <strong>Rate this book</strong>
        {% with book.user_rating as current_rating %}
        <form id="rating-form-{{ book.id }}" method="post" action="{% url 'set_rating' book.id %}">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.get_full_path }}">
            <div class="btn-group stars d-flex flex-row-reverse" role="group" aria-label="Rating">
                <input type="radio" name="rating" id="star-{{ book.id }}-5" value="5" {% if current_rating == 5 %}checked{% endif %}>
                <label class="star" title="5 stars" for="star-{{ book.id }}-5">★</label>
                <input type="radio" name="rating" id="star-{{ book.id }}-4" value="4" {% if current_rating == 4 %}checked{% endif %}>
                <label class="star" title="4 stars" for="star-{{ book.id }}-4">★</label>
                <input type="radio" name="rating" id="star-{{ book.id }}-3" value="3" {% if current_rating == 3 %}checked{% endif %}>
                <label class="star" title="3 stars" for="star-{{ book.id }}-3">★</label>
                <input type="radio" name="rating" id="star-{{ book.id }}-2" value="2" {% if current_rating == 2 %}checked{% endif %}>
                <label class="star" title="2 stars" for="star-{{ book.id }}-2">★</label>
                <input type="radio" name="rating" id="star-{{ book.id }}-1" value="1" {% if current_rating == 1 %}checked{% endif %}>
                <label class="star" title="1 star" for="star-{{ book.id }}-1">★</label>
            </div>
       </form>
       {% endwith %}
    {% else %}
        <small class="text-muted">Log in to rate this book</small>
        <a href="{{ login_url }}?next={{ request.get_full_path|urlencode }}" class="btn-no-decoration">
            <div class="stars d-flex flex-row-reverse">
                <span class="star" title="5 stars">★</span>
                <span class="star" title="4 stars">★</span>
                <span class="star" title="3 stars">★</span>
                <span class="star" title="2 stars">★</span>
                <span class="star" title="1 star">★</span>
            </div>
        </a>
    {% endif %}
